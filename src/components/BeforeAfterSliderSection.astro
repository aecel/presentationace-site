---
/**
 * BeforeAfterSliderSection
 * - Before/After draggable comparison slider
 * - Prev/Next controls for multiple pairs
 *
 * Put images in /public/before-after/...
 * Put logo in /public/logo-mark.svg (or update LOGO_SRC)
 */

type Pair = {
  title: string
  beforeSrc: string
  afterSrc: string
  beforeAlt: string
  afterAlt: string
}

const SECTION_ID = "before-after"
const LOGO_SRC = "/logo-presentation-ace-A.svg" // <-- update to your mark/logo file

const pairs: Pair[] = [
  {
    title: "Text only title → On-brand title slide",
    beforeSrc: "/before-after/Slide01-b.PNG",
    afterSrc: "/before-after/Slide01-a.PNG",
    beforeAlt: "Before slide (draft)",
    afterAlt: "After slide (final)",
  },
  {
    title: "Complex sketch → Executive-ready slide",
    beforeSrc: "/before-after/Slide02-b.PNG",
    afterSrc: "/before-after/Slide02-a.PNG",
    beforeAlt: "Before slide (text-heavy)",
    afterAlt: "After slide (clean hierarchy)",
  },
  {
    title: "Sketched diagram → On-brand slide",
    beforeSrc: "/before-after/Slide03-b.PNG",
    afterSrc: "/before-after/Slide03-a.PNG",
    beforeAlt: "Before slide (inconsistent layout)",
    afterAlt: "After slide (consistent system)",
  },
  {
    title: "Sketched diagram → On-brand slide",
    beforeSrc: "/before-after/Slide04-b.PNG",
    afterSrc: "/before-after/Slide04-a.PNG",
    beforeAlt: "Before slide (draft)",
    afterAlt: "After slide (final)",
  },
  {
    title: "Text with diagram → On-brand slide",
    beforeSrc: "/before-after/Slide05-b.PNG",
    afterSrc: "/before-after/Slide05-a.PNG",
    beforeAlt: "Before slide (draft)",
    afterAlt: "After slide (final)",
  },
  {
    title: "Bullet points → Changed structure",
    beforeSrc: "/before-after/Slide06-b.PNG",
    afterSrc: "/before-after/Slide06-a.PNG",
    beforeAlt: "Before slide (draft)",
    afterAlt: "After slide (final)",
  },
  {
    title: "Text only → Reimagined as steps",
    beforeSrc: "/before-after/Slide07-b.PNG",
    afterSrc: "/before-after/Slide07-a.PNG",
    beforeAlt: "Before slide (draft)",
    afterAlt: "After slide (final)",
  },
  {
    title: "Huge table → Split into 2 cleaned up slides",
    beforeSrc: "/before-after/Slide08-b.PNG",
    afterSrc: "/before-after/Slide08-a.PNG",
    beforeAlt: "Before slide (draft)",
    afterAlt: "After slide (final)",
  },
  {
    title: "Huge table → Split into 2 cleaned up slides",
    beforeSrc: "/before-after/Slide09-b.PNG",
    afterSrc: "/before-after/Slide09-a.PNG",
    beforeAlt: "Before slide (draft)",
    afterAlt: "After slide (final)",
  },
]

const initial = pairs[0]
---

<section
  id={SECTION_ID}
  class="beforeAfter"
  data-beforeafter
  data-logo-src={LOGO_SRC}
  aria-labelledby="beforeAfter-title"
>
  <div class="shell">
    <header class="beforeAfter__header">
      <h2 id="beforeAfter-title" class="beforeAfter__titleBar">
        Before and after
      </h2>
      <p class="beforeAfter__intro">
        Drag the slider to compare the original slide (left) to the final slide
        (right).
      </p>
    </header>

    <div class="beforeAfter__wrap">
      <button
        class="beforeAfter__nav beforeAfter__nav--prev"
        type="button"
        data-beforeafter-prev
        aria-label="Previous"
      >
        ‹
      </button>

      <div class="compareCard" data-beforeafter-pairs={JSON.stringify(pairs)}>
        <p class="compareCard__caption" data-beforeafter-caption>
          {initial.title}
        </p>

        <div class="compare" data-beforeafter-compare style="--pos: 50%;">
          <!-- AFTER (full) -->
          <img
            class="compare__img compare__img--after"
            data-beforeafter-after-img
            src={initial.afterSrc}
            alt={initial.afterAlt}
            loading="lazy"
            decoding="async"
          />

          <!-- BEFORE (clipped) -->
          <img
            class="compare__img compare__img--before"
            data-beforeafter-before-img
            src={initial.beforeSrc}
            alt={initial.beforeAlt}
            loading="lazy"
            decoding="async"
          />

          <!-- Slider input (draggable) -->
          <input
            class="compare__range"
            data-beforeafter-range
            type="range"
            min="0"
            max="100"
            value="50"
            aria-label="Before/after slider"
          />

          <!-- Visible divider + logo handle -->
          <div class="compare__divider" aria-hidden="true"></div>
          <div class="compare__handle" aria-hidden="true">
            <img class="compare__logo" data-beforeafter-logo alt="" />
          </div>
        </div>

        <div class="compareCard__labels" aria-hidden="true">
          <span class="compareCard__label">Before</span>
          <span class="compareCard__label">After</span>
        </div>

        <div class="dots" aria-label="Comparison set selector">
          {
            pairs.map((_, i) => (
              <button
                class:list={["dots__dot", i === 0 && "is-active"]}
                type="button"
                data-beforeafter-dot
                data-index={i}
                aria-label={`View set ${i + 1}`}
              />
            ))
          }
        </div>

        {/* Data for JS */}
        <!-- <script type="application/json" data-beforeafter-data>
          {JSON.stringify(pairs)}
        </script> -->
      </div>

      <button
        class="beforeAfter__nav beforeAfter__nav--next"
        type="button"
        data-beforeafter-next
        aria-label="Next"
      >
        ›
      </button>
    </div>
  </div>

  <script src="/js/before-after-slider.js" type="module"></script>

  <style>
    .beforeAfter {
      --ink: #2a2c27;
      --accent: #cf729c;

      --text: #2b2b2b;
      --muted: #6e6e6e;

      --card: #ffffff;
      --border: rgba(0, 0, 0, 0.1);
      --shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
      --radius: 16px;

      padding: clamp(28px, 5vw, 56px) 16px;
      color: var(--text);
    }

    .beforeAfter .shell {
      max-width: 1100px;
      margin: 0 auto;
    }

    .beforeAfter__header {
      text-align: center;
      margin-bottom: 18px;
    }

    /* .beforeAfter__titleBar {
      margin: 0 auto;
      display: inline-block;
      background: var(--ink);
      color: #fff;
      padding: 12px 22px;
      border-radius: 10px;
      font-weight: 800;
      font-size: clamp(1.2rem, 2vw, 1.5rem);
      letter-spacing: 0.2px;
    } */
    .beforeAfter__titleBar {
      margin: 0;
      font-size: clamp(1.6rem, 2.2vw, 2.1rem);
      font-weight: 800;
      color: var(--ink);
    }

    .beforeAfter__intro {
      margin: 12px 0 0;
      color: var(--muted);
      font-size: 0.95rem;
    }

    .beforeAfter__wrap {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      margin-top: 18px;
    }

    .beforeAfter__nav {
      width: 44px;
      height: 44px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      font-size: 30px;
      line-height: 1;
      color: var(--ink);
      display: grid;
      place-items: center;
      user-select: none;
    }

    .compareCard {
      flex: 1;
      max-width: 980px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 12px;
    }

    .compareCard__caption {
      margin: 0 0 10px;
      text-align: center;
      color: var(--muted);
      font-size: 0.95rem;
      line-height: 1.5;
    }

    .compare {
      position: relative;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid rgba(0, 0, 0, 0.1);
      background: #f7f7f7;
      aspect-ratio: 16 / 9;
      --pos: 50%;
    }

    .compare__img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: contain; /* slides typically look best as contain */
      display: block;
      background: #fff;
    }

    .compare__img--after {
      z-index: 1;
    }

    .compare__img--before {
      z-index: 2;
      /* Clip the right side based on the slider position */
      clip-path: inset(0 calc(100% - var(--pos)) 0 0);
    }

    /* Range (draggable) */
    .compare__range {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      margin: 0;
      opacity: 0; /* we use a custom visual handle */
      cursor: ew-resize;
    }

    /* Visible divider line */
    .compare__divider {
      position: absolute;
      top: 0;
      bottom: 0;
      left: var(--pos);
      width: 4px;
      transform: translateX(-2px);
      background: rgba(0, 0, 0, 0.45);
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.35);
      pointer-events: none;
    }

    /* Visible handle with logo */
    .compare__handle {
      position: absolute;
      top: 50%;
      left: var(--pos);
      transform: translate(-50%, -50%);
      width: 54px;
      height: 54px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.96);
      border: 1px solid rgba(0, 0, 0, 0.16);
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.18);
      display: grid;
      place-items: center;
      pointer-events: none; /* the invisible range input handles dragging */
    }

    .compare__logo {
      width: 28px;
      height: 28px;
      object-fit: contain;
      display: block;
      opacity: 0.95;
    }

    .compareCard__labels {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      color: var(--muted);
      font-size: 0.9rem;
      padding: 0 6px;
    }

    .dots {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 10px;
    }

    .dots__dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      border: 0;
      background: rgba(0, 0, 0, 0.2);
      cursor: pointer;
    }

    .dots__dot.is-active {
      background: rgba(0, 0, 0, 0.65);
    }

    @media (max-width: 900px) {
      .beforeAfter__wrap {
        flex-direction: column;
        gap: 10px;
      }

      .beforeAfter__nav {
        width: 100%;
        height: 44px;
        border-radius: 12px;
        font-size: 28px;
      }
    }

    /* Force hidden behavior */
    .beforeAfter [hidden] {
      display: none !important;
    }

    .compare__range {
      z-index: 5;
    }
    .compare__divider {
      z-index: 6;
    }
    .compare__handle {
      z-index: 7;
    }
    .compare__img {
      z-index: 1;
    }
    .compare__before {
      z-index: 2;
    }
  </style>
</section>
